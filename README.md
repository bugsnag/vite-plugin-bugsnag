<div align="center">
  <a href="https://www.bugsnag.com/platforms/javascript">
    <picture>
      <source media="(prefers-color-scheme: dark)" srcset="https://assets.smartbear.com/m/3dab7e6cf880aa2b/original/BugSnag-Repository-Header-Dark.svg">
      <img alt="SmartBear BugSnag logo" src="https://assets.smartbear.com/m/3945e02cdc983893/original/BugSnag-Repository-Header-Light.svg">
    </picture>
  </a>
  <h1>Vite plugins for common BugSnag actions</h1>
</div>

## Installation

```
npm install --save-dev vite-plugin-bugsnag
```

## Usage

### Build reporter plugin

Reports your build to BugSnag. This plugin hooks into the `buildEnd` event once all output files have been generated by the Vite compiler. If anything causes the compilation to fail before this step, the build report will not be sent.

```js
import { defineConfig } from "vite";
import { BugsnagBuildReporterPlugin } from "vite-plugin-bugsnag";

export default defineConfig({
  base: 'https://example.com/',
  build: {
    sourcemap: true,
  },
  plugins: [
    BugsnagBuildReporterPlugin({
      apiKey: 'YOUR_API_KEY',
      appVersion: '1.2.3'
    })
  ]
});
```

#### Config options

| Property | Type    | Description   |
| -------- | ------- | ------------- |
| `apiKey` | `string` | your BugSnag API key __[required]__ |
| `appVersion` | `string` | the version of the application you are building (this should match the `appVersion` configured in your notifier). Defaults to the version set in your project's package.json file, if one is specified there. |
| `autoAssignRelease` | `boolean` | automatically associate this build with any new error events and sessions that are received for the `releaseStage` until a subsequent build notification is received. If this is set to `true` and no `releaseStage` is provided the build will be applied to `'production'`. You should only use this option if you aren't able to set an `appVersion` in your notifier. |
| `builderName` | `string` | the name of the person/machine that created this build (defaults to the result of the `whoami` command) |
| `metadata` | `object` | key-value pairs containing any custom information about the build (e.g. configuration parameters, dependency versions, etc). The keys and values must be strings. Nested objects aren't supported. |
| `releaseStage` | `string` | `'production'`, `'staging'`, etc. (Leave blank if this build applies to multiple `releaseStage`s. New releases will be created when events are received with their respective `releaseStage`) |
| `sourceControl` | `object` | an object describing the source control of the build (if not specified, the module will attempt to detect source control information from `.git`, `.hg` and the nearest `package.json`) |
| `sourceControl.provider` | `string` | can be one of: `'github'`, `'github-enterprise'`, `'gitlab'`, `'gitlab-onpremise'`, `'bitbucket'`, `'bitbucket-server'` |
| `sourceControl.repository` | `string` | a URL (`git`/`ssh`/`https`) pointing to the repository, or webpage representing the repository |
| `sourceControl.revision` | `string` | the unique identifier for the commit (e.g. git SHA) |
| `endpoint` | `string` | Defaults to `https://build.bugsnag.com`. If you are using BugSnag On-premise use your BugSnag Build API endpoint |
| `logLevel` | `string` | the minimum severity of log to output (`'debug'`, `'info'`, `'warn'`, `'error'`), default `'warn'` |
| `logger` | `object` | provide a different logger object `{ debug, info, warn, error }` |
<!-- | `path` | `string` | the path to search for source control info, defaults to `process.cwd()` | -->


### Sourcemap uploader plugin

```js
import { defineConfig } from "vite";
import { BugsnagSourceMapUploaderPlugin } from "vite-plugin-bugsnag";

export default defineConfig({
  base: 'https://example.com/',
  build: {
    sourcemap: true,
  },
  plugins: [
    BugsnagSourceMapUploaderPlugin({
      apiKey: 'YOUR_API_KEY',
      appVersion: '1.2.3'
    })
  ]
});
```

#### Config options

| Property | Type    | Description   |
| -------- | ------- | ------------- |
| `apiKey` | `string` | Your BugSnag API key __[required]__ |
| `appVersion` | `string` | The version of the application you are building (this should match the `appVersion` configured in your notifier). Defaults to the `version` set in your project's `package.json` file, if one is specified there. |
| `base` | `string` | The URL of the base directory for the minified JavaScript files that the source maps relate to. The relative path is appended onto this for each file. Defaults to [`base`](https://vite.dev/config/shared-options.html#base) from your Vite configuration. |
| `endpoint` | `string` | Defaults to `https://upload.bugsnag.com/sourcemap`. If you are using BugSnag On-premise use your BugSnag Upload API endpoint |
| `codeBundeId` | `string` | A unique identifier for the JavaScript bundle. |
| `mode` | `string` | Defaults to `development` for serve, `production` for build |
| `projectRoot` | `string` | The path to your bundled assets as it appears in a stack trace. For an app running in a browser this is typically a URL. Defaults to [`root`](https://vite.dev/config/shared-options.html#root) from your Vite configuration. |
| `overwrite` | `boolean` | Whether you want to overwrite previously uploaded source maps for the same path and `appVersion`. Defaults to `false`. |
| `logLevel` | `string` | Sets the level of logging to `debug`, `info`, `warn` or `fatal`. |

## Support

- [Search open and closed issues](https://github.com/bugsnag/vite-plugin-bugsnag/issues?q=is%3Aissue) issues for similar problems
- [Report a bug or request a feature](https://github.com/bugsnag/vite-plugin-bugsnag/issues/new)
- Email [support@bugsnag.com](mailto:support@bugsnag.com)

## Contributing

All contributors are welcome! See our [contributing guide](docs/CONTRIBUTING.md).

## License

This module is free software released under the MIT License. See [LICENSE](LICENSE) for details.
